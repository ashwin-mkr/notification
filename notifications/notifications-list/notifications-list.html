<div class="card-body p-0 projects">
  <div class="table-responsive theme-scrollbar">
    <div class="dataTables_wrapper no-footer">

      <!-- Heading -->
      <h4 class="mb-3 px-3 pt-3">All Notifications</h4>

      <!-- Filters -->
      <div class="d-flex justify-content-between align-items-center mb-3 px-3">
        <div>
          <label><input type="date" class="form-control" [formControl]="dateControl" (change)="applyFilter()" /></label>
        </div>

        <div class="d-flex align-items-center">
          <input matInput placeholder="Search..." class="form-control me-2" [formControl]="searchControl" />
          <button class="btn btn-primary" (click)="applyFilter()">Search</button>
        </div>
      </div>

      <!-- Error -->
      <div *ngIf="error" class="alert alert-danger mx-3">{{ error }}</div>

      <!-- Loading -->
      <div *ngIf="loading" class="text-center py-3">Loading...</div>

      <!-- Table -->
      <table mat-table [dataSource]="dataSource" class="table display dataTable no-footer" id="notification-table"
        *ngIf="!loading && dataSource.data.length" matSort>

        <!-- S.No -->
        <ng-container matColumnDef="sno">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
          <td mat-cell *matCellDef="let item; let i = index">
            <div class="d-flex align-items-center">
              <div class="flex-grow-1 ms-2">
                <h6>{{ i + 1 }}</h6>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- From -->
        <ng-container matColumnDef="from">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> From </th>
          <td mat-cell *matCellDef="let item">
            <div class="d-flex align-items-center">
              <div class="flex-grow-1 ms-2">
                <h6>{{ item.tickets?.user?.username || item.user?.username || 'Unknown' }}</h6>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Message -->
        <ng-container matColumnDef="message">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Message </th>
          <td mat-cell *matCellDef="let item">
            <div class="d-flex align-items-center">
              <div class="flex-grow-1 ms-2">
                <h6>{{ item.message }}</h6>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Actions -->
        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let item">
            <div class="d-flex align-items-center">
              <div class="flex-grow-1 ms-2">
                <button class="btn btn-sm btn-outline-primary" (click)="toggleReadStatus(item)">
                  {{ item.read ? 'Mark as Unread' : 'Mark as Read' }}
                </button>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Table rows -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      <!-- No Data -->
      <div *ngIf="!loading && !dataSource.data.length" class="text-muted text-center py-3">
        No notifications found.
      </div>

      <!-- Paginator -->
      <div class="d-flex justify-content-end px-3 pb-3">
        <mat-paginator [pageSizeOptions]="[5, 10, 25]" showFirstLastButtons></mat-paginator>
      </div>

    </div>
  </div>
</div>
