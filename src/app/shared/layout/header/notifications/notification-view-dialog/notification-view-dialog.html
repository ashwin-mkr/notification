<div class="notification-dialog-container">
  <div class="dialog-header">
    <h2 mat-dialog-title class="dialog-title">
      <i class="fas fa-bell notification-icon"></i>
      Notification Details
    </h2>
    <button mat-icon-button class="close-button" mat-dialog-close type="button" aria-label="Close dialog">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <hr class="notification-divider" />

  <mat-dialog-content class="dialog-content">
    <div class="notification-details">
      <!-- Date Information -->
      <div class="detail-row">
        <div class="detail-label">
          <i class="fas fa-calendar-alt"></i>
          <strong>Date:</strong>
        </div>
        <div class="detail-value">
          <span class="date-display">{{ formatDate(data.date) }}</span>
          <small class="relative-time">({{ getRelativeTime(data.date) }})</small>
        </div>
      </div>

      <!-- Sender Information -->
      <div class="detail-row">
        <div class="detail-label">
          <i class="fas fa-user"></i>
          <strong>From:</strong>
        </div>
        <div class="detail-value">
          <div class="sender-info">
            <img 
              [src]="getSenderAvatar()" 
              [alt]="getSenderName()"
              class="sender-avatar"
              (error)="onAvatarError($event)"
            />
            <div class="sender-details">
              <span class="sender-name">{{ getSenderName() }}</span>
              <span class="sender-type" *ngIf="getSenderType()">{{ getSenderType() }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Message Content -->
      <div class="detail-row message-row">
        <div class="detail-label">
          <i class="fas fa-envelope"></i>
          <strong>Message:</strong>
        </div>
        <div class="detail-value">
          <div class="message-content">
            <p>{{ data.message }}</p>
            <div class="message-metadata" *ngIf="data.metadata">
              <div class="metadata-item" *ngFor="let item of getMetadataItems()">
                <strong>{{ item.key }}:</strong> {{ item.value }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Notification Type -->
      <div class="detail-row" *ngIf="data.type">
        <div class="detail-label">
          <i class="fas fa-tag"></i>
          <strong>Type:</strong>
        </div>
        <div class="detail-value">
          <span class="notification-type-badge" [class]="'type-' + data.type">
            <i [class]="getTypeIcon(data.type)"></i>
            {{ getTypeLabel(data.type) }}
          </span>
        </div>
      </div>

      <!-- Priority Level -->
      <div class="detail-row" *ngIf="data.priority">
        <div class="detail-label">
          <i class="fas fa-exclamation-circle"></i>
          <strong>Priority:</strong>
        </div>
        <div class="detail-value">
          <span class="priority-badge" [class]="'priority-' + data.priority">
            <i [class]="getPriorityIcon(data.priority)"></i>
            {{ getPriorityLabel(data.priority) }}
          </span>
        </div>
      </div>

      <!-- Read Status -->
      <div class="detail-row">
        <div class="detail-label">
          <i class="fas fa-eye"></i>
          <strong>Status:</strong>
        </div>
        <div class="detail-value">
          <span class="status-badge" [class]="data.read ? 'status-read' : 'status-unread'">
            <i [class]="data.read ? 'fas fa-check-circle' : 'fas fa-circle'"></i>
            {{ data.read ? 'Read' : 'Unread' }}
          </span>
        </div>
      </div>

      <!-- Ticket Information (if applicable) -->
      <div class="detail-row" *ngIf="data.tickets?.id">
        <div class="detail-label">
          <i class="fas fa-ticket-alt"></i>
          <strong>Ticket ID:</strong>
        </div>
        <div class="detail-value">
          <span class="ticket-id">{{ data.tickets.id }}</span>
        </div>
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions class="dialog-actions" align="end">
    <!-- Accept Button for Ticket Notifications -->
    <button
      *ngIf="isTicketNotification(data.message) && !isTicketAccepted"
      mat-raised-button
      color="primary"
      class="accept-button"
      (click)="accept()"
      [disabled]="isAccepting"
      type="button"
    >
      <i class="fas fa-spinner fa-spin" *ngIf="isAccepting"></i>
      <i class="fas fa-check" *ngIf="!isAccepting"></i>
      {{ isAccepting ? 'Accepting...' : 'Accept Ticket' }}
    </button>

    <!-- Mark as Read/Unread Button -->
    <button
      mat-button
      class="mark-read-button"
      (click)="toggleReadStatus()"
      type="button"
    >
      <i [class]="data.read ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
      {{ data.read ? 'Mark as Unread' : 'Mark as Read' }}
    </button>

    <!-- Close Button -->
    <button mat-button class="close-button-action" mat-dialog-close type="button">
      <i class="fas fa-times"></i>
      Close
    </button>
  </mat-dialog-actions>
</div>